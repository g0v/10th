#!/usr/bin/env bash
trap "kill 0" exit

# pino-pretty params
#  -i : ignore
#  -c : color
#  -t : format timestamp

# TODO This should be done via some kind of service
while [ 1 ]; do
  lsc arch | tee -a server.log | ./node_modules/.bin/pino-pretty -c -i req,res,hostname,pid -t "yyyy/mm/dd HH:MM:sso"
  echo "server down; try to auto restart after 1s."
  sleep 1;
done

wait
