!function(){var o,t;o=function(t){return t.name+"@"+(t.version||"")+":"+(t.path||"")},(t=function(t){return this.mgr=(t=null==t?{}:t).manager,this.store=window.localStorage,this._apiRoot=opt.api||"/api/consent","/"!==(t=this._apiRoot)[t.length-1]&&(this._apiRoot+="/"),this}).prototype=function(t,e){var n,r={}.hasOwnProperty;for(n in e)r.call(e,n)&&(t[n]=e[n]);return t}(Object.create(Object.prototype),{prompt:function(t){return mgr.get(t).then(function(t){return t.create()}).then(function(t){return t.attach({root:document.body}).then(function(){return t.interface()})}).then(function(t){return t.get()})},ensure:function(t){var e=this,n="consent/"+o(t),r=this.store.getItem(n);if(r)try{return JSON.parse(r),Promise.resolve(!0)}catch(t){0}return ld$.fetch(this._apiRoot+"/query",{method:"POST"},{body:{consent_id:n},type:"json"}).then(function(t){return!!t||lderror.reject(1018)}).catch(function(){return e.prompt(t).then(function(t){return!!t||lderror.reject(1018)})}).catch(function(t){return 1018!==t.id&&Promise.reject(t)})}}),"undefined"!=typeof module&&null!==module?module.exports=t:window.consent=t}.call(this);
